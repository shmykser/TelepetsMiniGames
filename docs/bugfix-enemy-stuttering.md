# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –†—ã–≤–∫–∏ —É –∂—É–∫–∞ –∏ –ø–∞—É–∫–∞ (Stuttering Movement)

## –ü—Ä–æ–±–ª–µ–º–∞

–ü–æ—Å–ª–µ –≤–∫–ª—é—á–µ–Ω–∏—è pathfinding –∂—É–∫ –∏ –ø–∞—É–∫ –Ω–∞—á–∞–ª–∏ –¥–≤–∏–≥–∞—Ç—å—Å—è **—Ä—ã–≤–∫–∞–º–∏** (—Å—Ç–æ–ø-—Å—Ç–∞—Ä—Ç –ø–æ–≤–µ–¥–µ–Ω–∏–µ):
- –î–≤–∏–≥–∞—é—Ç—Å—è ~2 —Å–µ–∫—É–Ω–¥—ã
- –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –∏ —Å—Ç–æ—è—Ç ~5 —Å–µ–∫—É–Ω–¥
- –°–Ω–æ–≤–∞ –¥–≤–∏–≥–∞—é—Ç—Å—è
- –¶–∏–∫–ª –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è

**–ú—É—Ä–∞–≤–µ–π** –¥–≤–∏–≥–∞–ª—Å—è –ø–ª–∞–≤–Ω–æ –±–µ–∑ –æ—Å—Ç–∞–Ω–æ–≤–æ–∫.

## –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤—Ä–∞–≥–æ–≤

**–ú—É—Ä–∞–≤–µ–π (–ø–ª–∞–≤–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ):**
```javascript
attack: {
    strategy: 'simple',
    damage: 3,
    range: -5,      // ‚ùó –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π
    cooldown: 5000
}
```

**–ñ—É–∫ (—Ä—ã–≤–∫–∞–º–∏):**
```javascript
attack: {
    strategy: 'simple',
    damage: 10,
    range: 35,      // ‚ùó –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π
    cooldown: 5000
}
```

**–ü–∞—É–∫ (—Ä—ã–≤–∫–∞–º–∏):**
```javascript
attack: {
    strategy: 'simple',
    damage: 10,
    range: 0,       // ‚ùó –ù–æ–ª—å
    cooldown: 5000
}
```

### –†–∞—Å—á–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ —Ä–∞–¥–∏—É—Å–∞ –∞—Ç–∞–∫–∏

–§–æ—Ä–º—É–ª–∞: `effectiveRange = baseRange + (attackerSize / 2) + (targetSize / 2)`

- **–ú—É—Ä–∞–≤–µ–π**: `-5 + 16 + 32 = 43 –ø–∏–∫—Å–µ–ª—è` (–º–∞–ª—ã–π —Ä–∞–¥–∏—É—Å)
- **–ñ—É–∫**: `35 + 32 + 32 = 99 –ø–∏–∫—Å–µ–ª–µ–π` (–±–æ–ª—å—à–æ–π —Ä–∞–¥–∏—É—Å)
- **–ü–∞—É–∫**: `0 + 32 + 32 = 64 –ø–∏–∫—Å–µ–ª—è` (—Å—Ä–µ–¥–Ω–∏–π —Ä–∞–¥–∏—É—Å)

### –°—É—Ç—å –±–∞–≥–∞ –≤ AICoordinator

**–ë—ã–ª–æ (—Å—Ç—Ä–æ–∫–∏ 220-226):**
```javascript
if (attackSystem && attackStrategy !== 'none') {
    if (attackSystem.isInRange()) {
        this.setState('attacking');
        attackSystem.attack(this.currentTarget);
        return; // ‚ùå –ë–ï–ó–£–°–õ–û–í–ù–´–ô –í–´–•–û–î
    }
}
```

**–¶–∏–∫–ª –ø–æ–≤–µ–¥–µ–Ω–∏—è:**

1. –í—Ä–∞–≥ –¥–≤–∏–∂–µ—Ç—Å—è –∫ —è–π—Ü—É
2. **–í—Ö–æ–¥–∏—Ç –≤ —Ä–∞–¥–∏—É—Å –∞—Ç–∞–∫–∏** (99px –¥–ª—è –∂—É–∫–∞)
   - `isInRange()` ‚Üí `true`
3. `attack()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
   - –ü–µ—Ä–≤—ã–π —Ä–∞–∑: `canAttack()` ‚Üí `true`, –∞—Ç–∞–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è ‚úÖ
   - –°–ª–µ–¥—É—é—â–∏–µ 5 —Å–µ–∫—É–Ω–¥: `canAttack()` ‚Üí `false` (cooldown) ‚ùå
4. **`coordinateSystems()` –¥–µ–ª–∞–µ—Ç `return`**
   - –ö–æ–¥ –¥–≤–∏–∂–µ–Ω–∏—è (—Å—Ç—Ä–æ–∫–∏ 236-266) **–ù–ï –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è**
   - **–í—Ä–∞–≥ —Å—Ç–æ–∏—Ç –∏ –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç** üõë
5. –ß–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥ cooldown –ø—Ä–æ—Ö–æ–¥–∏—Ç, –∞—Ç–∞–∫–∞ —Å–Ω–æ–≤–∞ ‚Üí —Ü–∏–∫–ª –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è

### –ü–æ—á–µ–º—É –º—É—Ä–∞–≤–µ–π –Ω–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª—Å—è

- **–ú–∞–ª—ã–π `effectiveRange`** (43px)
- **–ë—ã—Å—Ç—Ä–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å** (60 vs 30 —É –∂—É–∫–∞)
- –û–Ω –ª–∏–±–æ –±—ã—Å—Ç—Ä–æ –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –∑–æ–Ω—É –∞—Ç–∞–∫–∏
- –õ–∏–±–æ –∞—Ç–∞–∫—É–µ—Ç –∏ —Å—Ä–∞–∑—É –≤—ã—Ö–æ–¥–∏—Ç –∏–∑ —Ä–∞–¥–∏—É—Å–∞
- –ë–æ–ª—å—à—É—é —á–∞—Å—Ç—å –≤—Ä–µ–º–µ–Ω–∏ `isInRange() = false` ‚Üí –¥–≤–∏–∂–µ–Ω–∏–µ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è

### –ü–æ—á–µ–º—É —Å—Ç–∞–ª–æ –∑–∞–º–µ—Ç–Ω–æ –ø–æ—Å–ª–µ pathfinding

**–ë–ï–ó pathfinding:**
- –í—Ä–∞–≥–∏ –∑–∞—Å—Ç—Ä–µ–≤–∞–ª–∏ –≤ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è—Ö
- –†—ã–≤–∫–∏ –±—ã–ª–∏ –º–µ–Ω–µ–µ –∑–∞–º–µ—Ç–Ω—ã –Ω–∞ —Ñ–æ–Ω–µ –¥—Ä—É–≥–∏—Ö –ø—Ä–æ–±–ª–µ–º

**–° pathfinding:**
- –í—Ä–∞–≥–∏ **—Ç–æ—á–Ω–æ** –Ω–∞—Ö–æ–¥—è—Ç –ø—É—Ç—å –∫ —è–π—Ü—É
- –ü–æ–¥—Ö–æ–¥—è—Ç **–±–ª–∏–∂–µ –∏ —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ**
- –ü–æ–ø–∞–¥–∞—é—Ç –≤ —Ä–∞–¥–∏—É—Å –∞—Ç–∞–∫–∏ –∏ **–∑–∞—Å—Ç—Ä–µ–≤–∞—é—Ç —Ç–∞–º**
- –†—ã–≤–∫–∏ —Å—Ç–∞–ª–∏ **–æ—á–µ–≤–∏–¥–Ω—ã** üëÄ

## –†–µ—à–µ–Ω–∏–µ

–ò–∑–º–µ–Ω–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –≤ `AICoordinator.coordinateSystems()`:

**–°–¢–ê–õ–û (—Å—Ç—Ä–æ–∫–∏ 219-234):**
```javascript
if (attackSystem && attackStrategy !== 'none') {
    if (attackSystem.isInRange()) {
        // –ü—ã—Ç–∞–µ–º—Å—è –∞—Ç–∞–∫–æ–≤–∞—Ç—å
        const attackSuccessful = attackSystem.attack(this.currentTarget);
        
        // –ï—Å–ª–∏ –∞—Ç–∞–∫–∞ —É—Å–ø–µ—à–Ω–∞ (cooldown –ø—Ä–æ—à–µ–ª) - –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º—Å—è –¥–ª—è –∞—Ç–∞–∫–∏
        if (attackSuccessful) {
            this.setState('attacking');
            return;
        }
        // –ï—Å–ª–∏ –∞—Ç–∞–∫–∞ –Ω–µ—É–¥–∞—á–Ω–∞ (cooldown –Ω–µ –ø—Ä–æ—à–µ–ª) - –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –¥–≤–∏–∂–µ–Ω–∏–µ –Ω–∏–∂–µ
        // –≠—Ç–æ –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç –±–∞–≥ —Å —Ä—ã–≤–∫–∞–º–∏ —É –∂—É–∫–∞ –∏ –ø–∞—É–∫–∞
    }
}
// –î–∞–ª–µ–µ –∫–æ–¥ –¥–≤–∏–∂–µ–Ω–∏—è/pathfinding –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è
```

### –ù–æ–≤–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ

**–ö–∞–∂–¥—ã–π –∫–∞–¥—Ä:**

1. –í—Ä–∞–≥ –≤ —Ä–∞–¥–∏—É—Å–µ –∞—Ç–∞–∫–∏ ‚Üí `isInRange()` = `true`
2. –ü—ã—Ç–∞–µ—Ç—Å—è –∞—Ç–∞–∫–æ–≤–∞—Ç—å ‚Üí `attack()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:**
   - ‚úÖ **–ï—Å–ª–∏ `attackSuccessful = true`** (cooldown –ø—Ä–æ—à–µ–ª):
     - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ `'attacking'`
     - –î–µ–ª–∞–µ—Ç `return` ‚Üí –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –¥–ª—è –∞—Ç–∞–∫–∏
   - ‚ùå **–ï—Å–ª–∏ `attackSuccessful = false`** (cooldown –ù–ï –ø—Ä–æ—à–µ–ª):
     - **–ù–ï –¥–µ–ª–∞–µ—Ç `return`**
     - –ü—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –∫ –∫–æ–¥—É –¥–≤–∏–∂–µ–Ω–∏—è –Ω–∏–∂–µ
     - **–í—Ä–∞–≥ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –¥–≤–∏–≥–∞—Ç—å—Å—è** –ø–æ–∫–∞ –∂–¥–µ—Ç cooldown

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Ä–∞–≥–∏ –ø–ª–∞–≤–Ω–æ –¥–≤–∏–∂—É—Ç—Å—è –∫ —Ü–µ–ª–∏, –∞—Ç–∞–∫—É—é—Ç –∫–æ–≥–¥–∞ –º–æ–≥—É—Ç, –∏ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç –¥–≤–∏–∂–µ–Ω–∏–µ –≤–æ –≤—Ä–µ–º—è cooldown.

## –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- ‚úÖ `src/systems/core/AICoordinator.js` (—Å—Ç—Ä–æ–∫–∏ 219-234)

## –ü—Ä–æ–≤–µ—Ä–∫–∞

### –ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

1. **–ñ—É–∫ –∏ –ø–∞—É–∫** –¥–æ–ª–∂–Ω—ã –¥–≤–∏–≥–∞—Ç—å—Å—è **–ø–ª–∞–≤–Ω–æ** –±–µ–∑ –æ—Å—Ç–∞–Ω–æ–≤–æ–∫
2. **–ê—Ç–∞–∫–∏** –¥–æ–ª–∂–Ω—ã —Å—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å **—Ä–∞–∑ –≤ 5 —Å–µ–∫—É–Ω–¥** (cooldown)
3. **–ú–µ–∂–¥—É –∞—Ç–∞–∫–∞–º–∏** –≤—Ä–∞–≥–∏ **–ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç –¥–≤–∏–∂–µ–Ω–∏–µ**
4. **–ú—É—Ä–∞–≤–µ–π** –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ —Ä–∞–Ω—å—à–µ
5. **Pathfinding** –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ

- üêû –ñ—É–∫ –¥–≤–∏–∂–µ—Ç—Å—è –∫ —è–π—Ü—É, –∞—Ç–∞–∫—É–µ—Ç, –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –¥–≤–∏–∂–µ–Ω–∏–µ, –∞—Ç–∞–∫—É–µ—Ç —Å–Ω–æ–≤–∞
- üï∑Ô∏è –ü–∞—É–∫ –¥–≤–∏–∂–µ—Ç—Å—è –∫ —è–π—Ü—É, –∞—Ç–∞–∫—É–µ—Ç, –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –¥–≤–∏–∂–µ–Ω–∏–µ, –∞—Ç–∞–∫—É–µ—Ç —Å–Ω–æ–≤–∞
- üêú –ú—É—Ä–∞–≤–µ–π –¥–≤–∏–∂–µ—Ç—Å—è –∫–∞–∫ —Ä–∞–Ω—å—à–µ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –í—Å–µ –≤—Ä–∞–≥–∏ **–æ–±—Ö–æ–¥—è—Ç –∫–∞–º–Ω–∏** (pathfinding —Ä–∞–±–æ—Ç–∞–µ—Ç)

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### AttackSystem.attack() –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç boolean

```javascript
// AttackSystem.js
attack(target) {
    this.setTarget(target);
    return this.attackCurrentTarget(); // –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç true/false
}

attackCurrentTarget() {
    if (!this.currentTarget || !this.canAttack()) {
        return false; // ‚ùå –ù–µ –º–æ–∂–µ–º –∞—Ç–∞–∫–æ–≤–∞—Ç—å
    }
    if (!this.isInRange()) {
        return false; // ‚ùå –ù–µ –≤ —Ä–∞–¥–∏—É—Å–µ
    }
    return this.performAttack(); // ‚úÖ –ê—Ç–∞–∫—É–µ–º
}
```

### –¢–µ–ø–µ—Ä—å AICoordinator –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —ç—Ç–æ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç

- –£—Å–ø–µ—Ö ‚Üí –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è –¥–ª—è –∞—Ç–∞–∫–∏
- –ù–µ—É–¥–∞—á–∞ ‚Üí –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –¥–≤–∏–∂–µ–Ω–∏–µ

---

**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏ –≥–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é**

**–í–ª–∏—è–Ω–∏–µ**: –í—Å–µ –≤—Ä–∞–≥–∏ —Å `strategy: 'simple'` –∏ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º/–Ω—É–ª–µ–≤—ã–º `attack.range`

