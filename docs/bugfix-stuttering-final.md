# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä—ã–≤–∫–æ–≤ (stuttering) —É –≤—Ä–∞–≥–æ–≤ —Å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º attack.range

## –ü—Ä–æ–±–ª–µ–º–∞

–ñ—É–∫ (beetle) –∏ –ø–∞—É–∫ (spider) –¥–≤–∏–≥–∞–ª–∏—Å—å —Ä—ã–≤–∫–∞–º–∏ - —Å–µ–∫—É–Ω–¥—É –¥–≤–∏–∂–µ–Ω–∏—è, –∑–∞—Ç–µ–º —Å–µ–∫—É–Ω–¥–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏, –∏ —Ç–∞–∫ –ø–æ –∫—Ä—É–≥—É. –ü—Ä–∏ —ç—Ç–æ–º –º—É—Ä–∞–≤–µ–π (ant) –¥–≤–∏–≥–∞–ª—Å—è –ø–ª–∞–≤–Ω–æ –∏ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ.

## –ü—Ä–∏—á–∏–Ω–∞

–ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞ –±—ã–ª–∞ –≤ –º–µ—Ç–æ–¥–µ `isTargetReached()` –∫–ª–∞—Å—Å–∞ `LinearMovementStrategy`.

### –ú–µ—Ö–∞–Ω–∏–∑–º –±–∞–≥–∞:

1. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `effectiveAttackRange`**:
   - `LinearMovementStrategy.isTargetReached()` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ `GeometryUtils.effectiveAttackRange()` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è **–ª—é–±–æ–π** —Ü–µ–ª–∏ –¥–≤–∏–∂–µ–Ω–∏—è
   - –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã—á–∏—Å–ª—è–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π —Ä–∞–¥–∏—É—Å –∞—Ç–∞–∫–∏ —Å —É—á–µ—Ç–æ–º —Ä–∞–∑–º–µ—Ä–æ–≤ –æ–±—ä–µ–∫—Ç–æ–≤ –∏ –±–∞–∑–æ–≤–æ–≥–æ `attack.range`
   - –î–ª—è –∂—É–∫–∞: `attack.range = 35` ‚Üí `effectiveRange ‚âà 90` –ø–∏–∫—Å–µ–ª–µ–π
   - –î–ª—è –ø–∞—É–∫–∞: `attack.range = 0` ‚Üí `effectiveRange ‚âà 55` –ø–∏–∫—Å–µ–ª–µ–π
   - –î–ª—è –º—É—Ä–∞–≤—å—è: `attack.range = -40` (–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π!) ‚Üí `effectiveRange ‚âà 10-15` –ø–∏–∫—Å–µ–ª–µ–π

2. **–ü—Ä–æ–±–ª–µ–º–∞ —Å waypoints**:
   - –ü—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏ —Å pathfinding, –≤—Ä–∞–≥–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Ç–æ—á–∫–∏ (waypoints)
   - `isTargetReached()` –ø—Ä–æ–≤–µ—Ä—è–ª–∞ waypoint —Å –±–æ–ª—å—à–∏–º `effectiveRange`
   - –ñ—É–∫/–ø–∞—É–∫ "–¥–æ—Å—Ç–∏–≥–∞–ª–∏" waypoint —Å–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ (–Ω–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–∏ 90/55 –ø–∏–∫—Å–µ–ª–µ–π)
   - –í—Ä–∞–≥ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª—Å—è, –¥–∞–∂–µ –µ—Å–ª–∏ –Ω–µ –±—ã–ª —Ä–µ–∞–ª—å–Ω–æ –≤ —Ç–æ—á–∫–µ
   - –ß–µ—Ä–µ–∑ —Å–µ–∫—É–Ω–¥—É `MovementSystem.update()` –≤—ã–∑—ã–≤–∞–ª —Å–ª–µ–¥—É—é—â–∏–π waypoint, –∏ —Ü–∏–∫–ª –ø–æ–≤—Ç–æ—Ä—è–ª—Å—è

3. **–ü–æ—á–µ–º—É –º—É—Ä–∞–≤–µ–π –Ω–µ —Å—Ç—Ä–∞–¥–∞–ª**:
   - –£ –º—É—Ä–∞–≤—å—è `attack.range = -40` (–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π)
   - `effectiveRange` –ø–æ–ª—É—á–∞–ª—Å—è –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏–º (–æ–∫–æ–ª–æ 10 –ø–∏–∫—Å–µ–ª–µ–π)
   - –ú—É—Ä–∞–≤–µ–π –¥–æ–ª–∂–µ–Ω –±—ã–ª —Ä–µ–∞–ª—å–Ω–æ –¥–æ—Å—Ç–∏—á—å waypoint, —á—Ç–æ–±—ã `isTargetReached()` –≤–µ—Ä–Ω—É–ª `true`
   - –ü–æ—ç—Ç–æ–º—É –¥–≤–∏–∂–µ–Ω–∏–µ –±—ã–ª–æ –ø–ª–∞–≤–Ω—ã–º

### –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ –ª–æ–≥–∞—Ö:

```
üêû [beetle] –†–µ–∑—É–ª—å—Ç–∞—Ç –∞—Ç–∞–∫–∏: ‚ùå –ù–ï–£–î–ê–ß–ê (–ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –¥–≤–∏–∂–µ–Ω–∏–µ, doAttack=false)
üêû [beetle] üìç –ö–û–î –î–û–®–ï–õ –î–û –°–ï–ö–¶–ò–ò –î–í–ò–ñ–ï–ù–ò–Ø
üêû [beetle] üó∫Ô∏è –ò–°–ü–û–õ–¨–ó–£–ï–ú PATHFINDING
üêû [MovementSystem] moveAlongPath –≤—ã–∑–≤–∞–Ω
üêû [LinearStrategy] moveToTarget: –¥–∏—Å—Ç–∞–Ω—Ü–∏—è=0, effectiveRange=90, targetReached=true
üêû [LinearStrategy] ‚õî –¶–ï–õ–¨ –î–û–°–¢–ò–ì–ù–£–¢–ê - –û–°–¢–ê–ù–ê–í–õ–ò–í–ê–ï–ú–°–Ø
```

–í—Ä–∞–≥ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª—Å—è –≤ `LinearMovementStrategy`, –¥–∞–∂–µ –µ—Å–ª–∏ —Ç–æ–ª—å–∫–æ –Ω–∞—á–∞–ª –¥–≤–∏–∂–µ–Ω–∏–µ –ø–æ –ø—É—Ç–∏!

## –†–µ—à–µ–Ω–∏–µ

–ó–∞–º–µ–Ω–∏–ª–∏ `effectiveAttackRange` –Ω–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π `MOVEMENT_TOLERANCE = 10` –ø–∏–∫—Å–µ–ª–µ–π –≤ –º–µ—Ç–æ–¥–µ `isTargetReached()`.

### –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:

1. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏**:
   - –ó–∞–¥–∞—á–∞ `MovementStrategy` - –¥–æ–≤–µ—Å—Ç–∏ –æ–±—ä–µ–∫—Ç –¥–æ —Ç–æ—á–∫–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è (waypoint –∏–ª–∏ —Ñ–∏–Ω–∞–ª—å–Ω–∞—è —Ü–µ–ª—å)
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–¥–∏—É—Å–∞ –∞—Ç–∞–∫–∏ - –∑–∞–¥–∞—á–∞ `AttackSystem.isInRange()`
   - –≠—Ç–∏ –¥–≤–∞ —Ä–∞—Å—á–µ—Ç–∞ –ù–ï –¥–æ–ª–∂–Ω—ã –ø–µ—Ä–µ—Å–µ–∫–∞—Ç—å—Å—è

2. **–ï–¥–∏–Ω—ã–π tolerance –¥–ª—è –≤—Å–µ—Ö –≤—Ä–∞–≥–æ–≤**:
   - 10 –ø–∏–∫—Å–µ–ª–µ–π –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è waypoints
   - –í—Å–µ –≤—Ä–∞–≥–∏ (–º—É—Ä–∞–≤–µ–π, –∂—É–∫, –ø–∞—É–∫) —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—É—é –ª–æ–≥–∏–∫—É –¥–≤–∏–∂–µ–Ω–∏—è
   - –ù–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç `attack.range`, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –∏–º–µ–µ—Ç –æ—Ç–Ω–æ—à–µ–Ω–∏—è –∫ –¥–≤–∏–∂–µ–Ω–∏—é

3. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞—Ç–∞–∫—É—é—â–µ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è**:
   - `AICoordinator.coordinateSystems()` –≤—Å—ë –µ—â—ë –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `attackSystem.isInRange()` –ø–µ—Ä–µ–¥ –∞—Ç–∞–∫–æ–π
   - –ï—Å–ª–∏ –≤—Ä–∞–≥ –≤ —Ä–∞–¥–∏—É—Å–µ –∏ cooldown –ø—Ä–æ—à—ë–ª - –æ–Ω –∞—Ç–∞–∫—É–µ—Ç –∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è
   - –ï—Å–ª–∏ –≤—Ä–∞–≥ –≤ —Ä–∞–¥–∏—É—Å–µ, –Ω–æ cooldown –ù–ï –ø—Ä–æ—à—ë–ª - –æ–Ω –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –¥–≤–∏–≥–∞—Ç—å—Å—è (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –±–∞–≥–∞)
   - –ï—Å–ª–∏ –≤—Ä–∞–≥ –≤–Ω–µ —Ä–∞–¥–∏—É—Å–∞ - –æ–Ω –¥–≤–∏–≥–∞–µ—Ç—Å—è –ø–æ –ø—É—Ç–∏

## –ò–∑–º–µ–Ω–µ–Ω–∏—è

### `src/systems/strategies/movement/LinearMovementStrategy.js`

```javascript
isTargetReached(target) {
    if (!target || !this.gameObject) return false;
    const distance = GeometryUtils.distance(this.gameObject.x, this.gameObject.y, target.x, target.y);
    
    // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π tolerance –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ç–æ—á–µ–∫ –¥–≤–∏–∂–µ–Ω–∏—è (waypoints –∏–ª–∏ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π —Ü–µ–ª–∏)
    // –≠—Ç–æ –ù–ï —Ç–æ –∂–µ —Å–∞–º–æ–µ —á—Ç–æ attack range - —Ä–∞–¥–∏—É—Å –∞—Ç–∞–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤ AttackSystem.isInRange()
    // –ó–∞–¥–∞—á–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–≤–∏–∂–µ–Ω–∏—è - –ø—Ä–æ—Å—Ç–æ –¥–æ–≤–µ—Å—Ç–∏ –æ–±—ä–µ–∫—Ç –¥–æ —Ç–æ—á–∫–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è, –∞ –Ω–µ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ä–∞–¥–∏—É—Å –∞—Ç–∞–∫–∏
    const MOVEMENT_TOLERANCE = 10;
    
    return distance <= MOVEMENT_TOLERANCE;
}
```

**–£–¥–∞–ª–µ–Ω–æ:**
```javascript
// –°—Ç–∞—Ä—ã–π –∫–æ–¥:
const effectiveRange = GeometryUtils.effectiveAttackRange(
    this.gameObject,
    target,
    this.attackRange
);
return distance <= effectiveRange;
```

### –£–¥–∞–ª–µ–Ω—ã –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ –ª–æ–≥–∏

–£–¥–∞–ª–µ–Ω—ã –≤—Å–µ `console.log` –¥–ª—è –∂—É–∫–∞ –∏ –ø–∞—É–∫–∞ –∏–∑:
- `src/systems/strategies/movement/LinearMovementStrategy.js`
- `src/systems/core/AICoordinator.js`
- `src/systems/core/MovementSystem.js`
- `src/systems/core/AttackSystem.js`

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∏–≥—Ä—É
2. –ó–∞—Å–ø–∞–≤–Ω–∏—Ç—å –∂—É–∫–æ–≤, –ø–∞—É–∫–æ–≤ –∏ –º—É—Ä–∞–≤—å—ë–≤
3. –†–∞–∑–º–µ—Å—Ç–∏—Ç—å –∫–∞–º–Ω–∏ –Ω–∞ –ø—É—Ç–∏ –≤—Ä–∞–≥–æ–≤ (—á—Ç–æ–±—ã –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å pathfinding)
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å–µ –≤—Ä–∞–≥–∏ –¥–≤–∏–≥–∞—é—Ç—Å—è –ø–ª–∞–≤–Ω–æ, –±–µ–∑ —Ä—ã–≤–∫–æ–≤
5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Ä–∞–≥–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∞—Ç–∞–∫—É—é—Ç:
   - –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ cooldown –ø—Ä–æ—à—ë–ª
   - –ü—Ä–æ–¥–æ–ª–∂–∞—é—Ç –¥–≤–∏–≥–∞—Ç—å—Å—è –µ—Å–ª–∏ –≤ —Ä–∞–¥–∏—É—Å–µ, –Ω–æ cooldown –Ω–µ –ø—Ä–æ—à—ë–ª

## –°–≤—è–∑–∞–Ω–Ω—ã–µ –±–∞–≥–∏

–≠—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ–ø–æ–ª–Ω—è–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ `AICoordinator.coordinateSystems()`, –≥–¥–µ –º—ã –∏—Å–ø—Ä–∞–≤–∏–ª–∏ –ª–æ–≥–∏–∫—É:
- –¢–µ–ø–µ—Ä—å –≤—Ä–∞–≥ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –¢–û–õ–¨–ö–û –µ—Å–ª–∏ `attackSystem.attack()` –≤–µ—Ä–Ω—ë—Ç `true` (cooldown –ø—Ä–æ—à—ë–ª)
- –ï—Å–ª–∏ cooldown –ù–ï –ø—Ä–æ—à—ë–ª, –≤—Ä–∞–≥ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –¥–≤–∏–∂–µ–Ω–∏–µ, –¥–∞–∂–µ –Ω–∞—Ö–æ–¥—è—Å—å –≤ —Ä–∞–¥–∏—É—Å–µ –∞—Ç–∞–∫–∏

–û–±–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–º–µ—Å—Ç–µ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –ø–ª–∞–≤–Ω–æ–µ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –≤—Ä–∞–≥–æ–≤.

## –î–∞—Ç–∞
18.10.2025

